#### 为什么要给表加上主键?
>主键的作用就是把「表」的数据格式转换成「索引（平衡树）」的格式放置,表上了主键，那么表在磁盘上的存储结构就由整齐排列的结构转变成了树状结构，整个表就变成了一个索引,也就是所谓的「聚集索引」,这就是为什么一个表只能有一个主键， 一个表只能有一个「聚集索引」

#### 为什么加索引后会使查询变快？
>在未加上索引的情况下,按照常规的逻辑，一条条去匹配的话,最坏的情况的匹配O(n)次才能得到结果,如果这个n足够大的话.这是无法接受的,这N次匹配不经过缓存优化的情况下就是n次IO开销，如果把表转换成平衡树结构，那么时间复杂度就是成指数级下降.

#### 为什么加索引后会使写入、修改、删除变慢(加了索引后,会有什么副作用)？
>事物都有两面性,索引能让数据库查询数据的速度上升,而使写入数据的速度下降,原因很简单的,因为平衡树这个结构必须一直维持在一个正确的状态,增删改数据都会改变平衡树各节点中的索引数据内容,破坏树结构，因此，在每次数据改变时， DBMS必须去重新梳理树（索引）的结构以确保它的正确，这会带来不小的性能开销，也就是为什么索引会给查询以外的操作带来副作用的原因。


#### 什么情况下要同时在两个字段上建索引？
> 通过聚集索引可以查到需要查找的数据,而通过非聚集索引可以查到记录对应的主键值,再使用主键的值通过聚集索引查找到需要的数据,不管以任何方式查询表,最终都会利用主键通过聚集索引来定位到数据,聚集索引（主键）是通往真实数据所在的唯一路径.然而有一种例外可以不使用聚集索引就能查询出所需要的数据,这种非主流的方法 称之为「覆盖索引」查询,也就是平时所说的复合索引或者多字段索引查询

```
//建立索引
create index index_birthday on user_info(birthday);
```

假设我们进行以下的查询
```
select user_name from user_info where birthday = '1991-11-1'
```
这句话执行的操作如下:
1. 通过非聚集索引index_birthday查找birthday等于1991-11-1的所有记录的主键ID值
2. 通过得到的主键ID值执行聚集索引查找，找到主键ID值对就的真实数据（数据行）存储的位置
3. 从得到的真实数据中取得user_name字段的值返回， 也就是取得最终的结果

我们把birthday字段上的索引改成双字段的覆盖索引
```
create index index_birthday_and_user_name on user_info(birthday, user_name);
```

1. 通过非聚集索引index_birthday_and_user_name查找birthday等于1991-11-1的叶节点的内容.
2. 由于叶节点中除了有user_name表主键ID的值以外,user_name字段的值也在里面,因此不需要通过主键ID值的查找数据行的真实所在， 直接取得叶节点中user_name的值返回即可.
>通过这种覆盖索引直接查找的方式,可以省略不使用覆盖索引查找的后面两个步骤,大大的提高了查询性能

以上问题答案来源于[【最佳实践】陈大侠-深入浅出数据库索引原理](https://zhuanlan.zhihu.com/p/23624390)